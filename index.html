<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOOT_SEQUENCE // SHASHWAT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&display=swap" rel="stylesheet">

    <script>
        // --- 0. SMART SKIP LOGIC ---
        // If the user has already seen the boot sequence this session, skip immediately to home.
        if (sessionStorage.getItem('system_booted')) {
            window.location.href = 'home.html';
        }

        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { mono: ['Fira Code', 'monospace'] },
                    colors: { neonCyan: '#66fcf1', neonBlue: '#3b82f6', matrixGreen: '#0f0' }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #050505;
            color: #66fcf1;
            font-family: 'Fira Code', monospace;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* --- CRT SCREEN EFFECTS --- */
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom,
                    rgba(255, 255, 255, 0),
                    rgba(255, 255, 255, 0) 50%,
                    rgba(0, 0, 0, 0.2) 50%,
                    rgba(0, 0, 0, 0.2));
            background-size: 100% 4px;
            z-index: 50;
            pointer-events: none;
        }

        .crt-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(0, 0, 0, 0) 60%, rgba(0, 0, 0, 0.6) 100%);
            z-index: 51;
            pointer-events: none;
        }

        /* Text Glow Animation */
        @keyframes textShadow {
            0% {
                text-shadow: 0.4px 0 1px rgba(0, 30, 255, 0.5), -0.4px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
            }

            5% {
                text-shadow: 2px 0 1px rgba(0, 30, 255, 0.5), -2px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
            }

            100% {
                text-shadow: 0.4px 0 1px rgba(0, 30, 255, 0.5), -0.4px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px;
            }
        }

        .glow-text {
            animation: textShadow 1.6s infinite;
        }

        /* --- TERMINAL BOX --- */
        .terminal-container {
            width: 90%;
            max-width: 800px;
            height: 600px;
            display: flex;
            flex-direction: column;
            z-index: 10;
            padding: 20px;
        }

        .terminal-output {
            flex-grow: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            font-size: 14px;
            line-height: 1.5;
            white-space: pre-wrap;
        }

        /* Progress Bar */
        .progress-container {
            margin-top: 15px;
            border: 1px solid #333;
            padding: 2px;
            height: 24px;
            width: 100%;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: #66fcf1;
            width: 0%;
            transition: width 0.1s linear;
            box-shadow: 0 0 10px rgba(102, 252, 241, 0.5);
        }

        /* Status Colors */
        .text-ok {
            color: #10b981;
            font-weight: bold;
        }

        .text-warn {
            color: #f59e0b;
        }

        .text-err {
            color: #ef4444;
        }

        .text-dim {
            color: #4b5563;
        }

        /* The "Scanline" Bar moving down */
        .scanlines::before {
            content: " ";
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        /* CRT Turn Off Animation */
        @keyframes turn-off {
            0% {
                transform: scale(1, 1.3) translate3d(0, 0, 0);
                filter: brightness(1);
                opacity: 1;
            }

            60% {
                transform: scale(1, 0.001) translate3d(0, 0, 0);
                filter: brightness(10);
            }

            100% {
                animation-timing-function: cubic-bezier(0.755, 0.05, 0.855, 0.06);
                transform: scale(0, 0.001) translate3d(0, 0, 0);
                opacity: 0;
            }
        }

        body.redirecting {
            animation: turn-off 0.55s cubic-bezier(0.23, 1, 0.32, 1);
            animation-fill-mode: forwards;
        }

        /* Red Alert State */
        body.alert-state {
            background-color: #1a0000;
        }

        body.alert-state .terminal-container {
            box-shadow: 0 0 50px rgba(255, 0, 0, 0.3);
            border-color: #ef4444;
        }

        body.alert-state .text-neonCyan,
        body.alert-state .text-neonBlue {
            color: #ef4444 !important;
            text-shadow: 0 0 5px red;
        }

        /* Screen Shake */
        .shake {
            animation: shake 0.5s cubic-bezier(.36, .07, .19, .97) both;
        }

        @keyframes shake {

            10%,
            90% {
                transform: translate3d(-1px, 0, 0);
            }

            20%,
            80% {
                transform: translate3d(2px, 0, 0);
            }

            30%,
            50%,
            70% {
                transform: translate3d(-4px, 0, 0);
            }

            40%,
            60% {
                transform: translate3d(4px, 0, 0);
            }
        }
        #manual-entry {
    position: fixed;
    bottom: 20%;
    left: 50%;
    transform: translateX(-50%);
    z-index: 100;
    display: none; /* Hidden by default */
}
/* --- MOBILE OPTIMIZATION (LOADING SCREEN) --- */
        @media (max-width: 640px) {
            .terminal-container {
                width: 95%;
                height: 85vh; /* Taller on mobile to fit logs */
                padding: 10px;
            }
            .terminal-output {
                font-size: 11px; /* Smaller font for mobile */
                line-height: 1.4;
            }
            #task-status, #percentage {
                font-size: 10px;
            }
            /* Hide the heavy scanlines on mobile to save battery/performance */
            .scanlines {
                background-size: 100% 2px; 
            }
        }
    </style>
</head>

<body>
<a id="manual-entry" href="home.html" class="text-neonCyan border border-neonCyan px-6 py-2 hover:bg-neonCyan hover:text-black font-bold transition-all">
    [ MANUAL OVERRIDE: ENTER SYSTEM ]
</a>
    <div class="scanlines"></div>
    <div class="crt-overlay"></div>

    <div
        class="fixed top-4 right-4 font-mono text-xs text-gray-500 text-right z-50 pointer-events-none hidden sm:block">
        <div>CPU_CORE_0: <span id="cpu-temp" class="text-neonCyan">45°C</span></div>
        <div>VOLTAGE: <span id="sys-volt" class="text-neonBlue">1.2V</span></div>
        <div>MEM_ALLOC: <span id="mem-usage" class="text-yellow-500">124MB</span></div>
    </div>

    <div class="terminal-container glow-text">
        <div class="terminal-output" id="console"></div>

        <div class="mt-4 flex justify-between text-xs font-mono text-gray-500 mb-1">
            <span id="task-status">SYSTEM BOOT SEQUENCE</span>
            <span id="percentage">0%</span>
        </div>
        <div class="progress-container">
            <div class="progress-fill" id="progress-bar"></div>
        </div>
    </div>

    <script>
        const consoleDiv = document.getElementById('console');
        const progressBar = document.getElementById('progress-bar');
        const percentageText = document.getElementById('percentage');
        const taskStatus = document.getElementById('task-status');

        const ASCII_LOGO = `
   _____ __  __  ___  _____ __ __ __          __ ___  ______
  / ___// / / / /   |/ ___// // /| |  /\\  / //   |/_  __/
  \\__ \\/ /_/ / / /| |\\__ \\/ // / | | /  \\/ // /| | / /   
 ___/ / __  / / ___ ___/ / __  /  | |/ /\\  // ___ |/ /    
/____/_/ /_/ /_/  |_/____/_/ /_/   |___/  \\/_/  |_/_/     
                                                          
 >> INITIALIZING KERNEL v4.0.2...
`;

        // --- 1. HOLLYWOOD AUDIO MODULE ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playDataNoise() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);

            osc.type = 'square';
            osc.frequency.setValueAtTime(Math.random() * 1000 + 500, audioCtx.currentTime);
            gain.gain.setValueAtTime(0.02, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.05);

            osc.start();
            osc.stop(audioCtx.currentTime + 0.05);
        }

        function playHum() {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);

            osc.type = 'sine';
            osc.frequency.setValueAtTime(60, audioCtx.currentTime);
            gain.gain.setValueAtTime(0, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0.05, audioCtx.currentTime + 2);

            osc.start();
            return { osc, gain };
        }

        function playSuccessChime() {
            const frequencies = [523.25, 659.25, 783.99, 1046.50];
            frequencies.forEach((freq, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
                const start = audioCtx.currentTime + (i * 0.05);
                gain.gain.setValueAtTime(0, start);
                gain.gain.linearRampToValueAtTime(0.1, start + 0.1);
                gain.gain.exponentialRampToValueAtTime(0.001, start + 1.5);
                osc.start(start);
                osc.stop(start + 2);
            });
        }

        // --- 2. UTILITY FUNCTIONS ---
        function generateHex() {
            let hex = "";
            for (let i = 0; i < 40; i++) hex += Math.floor(Math.random() * 16).toString(16).toUpperCase() + " ";
            return hex;
        }

        function log(text, type = 'normal') {
            const line = document.createElement('div');
            if (type === 'hex') {
                line.className = 'text-dim text-xs';
                line.textContent = text;
            } else if (type === 'ascii') {
                line.className = 'text-neonCyan leading-tight font-bold mb-4';
                line.textContent = text;
            } else {
                line.innerHTML = text;
            }
            consoleDiv.appendChild(line);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        function decryptText(targetElement, text, speed = 50) {
            let iterations = 0;
            const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890@#$%^&*";
            const interval = setInterval(() => {
                targetElement.innerHTML = text
                    .split("")
                    .map((letter, index) => {
                        if (index < iterations) return text[index];
                        return chars[Math.floor(Math.random() * chars.length)];
                    })
                    .join("");

                if (iterations >= text.length) clearInterval(interval);
                iterations += 1 / 3;
            }, speed);
        }

        // --- 3. BOOT SEQUENCE DATA ---
        const bootSequence = [
            { text: "Mounting Virtual File System...", delay: 200 },
            { text: "Loading driver: <span class='text-white'>gpu_shader_core.so</span>", delay: 100 },
            { text: "Loading driver: <span class='text-white'>neural_net_v2.so</span>", delay: 100 },
            { text: "Allocating memory block 0x000A4F...", delay: 50 },
            { text: "Checking integrity of /root/portfolio...", delay: 300 },
            { text: "├── home.html ......................... <span class='text-ok'>[OK]</span>", delay: 100 },
            { text: "├── about.html ......................... <span class='text-ok'>[OK]</span>", delay: 100 },
            { text: "├── projects.html ...................... <span class='text-ok'>[OK]</span>", delay: 100 },
            { text: "└── contact.html ....................... <span class='text-ok'>[OK]</span>", delay: 100 },
            { text: "Calibrating cyber-grid visualizer...", delay: 400 },
            { text: "<span class='text-err'>[CRITICAL ERROR]</span> SEGMENTATION FAULT IN SECTOR 7G.", delay: 800 },
            { text: "Attempting auto-recovery...", delay: 400 },
            { text: "Rerouting power to auxiliary core...", delay: 300 },
            { text: "<span class='text-ok'>[SUCCESS]</span> Core stabilized. Resuming boot.", delay: 300 },
            { text: "Connection established. Latency: 12ms", delay: 150 },
            { text: "Decrypting user interface...", delay: 500 }
        ];

        // --- 4. MAIN RUNNER ---
        async function runBoot() {
            // Start Ambient Hum
            const hum = playHum();

            // PHASE 1: HEX DUMP TORRENT
            const torrentStartTime = Date.now();
            while (Date.now() - torrentStartTime < 1500) {
                const hex = Array(8).fill(0).map(() => Math.floor(Math.random() * 16).toString(16)).join('').toUpperCase();
                const binary = Math.random().toString(2).substr(2, 8);
                const memAddr = `0x${Math.floor(Math.random() * 9999).toString(16).toUpperCase().padStart(4, '0')}`;

                log(`${memAddr} :: ${hex} :: ${binary} ... [ALLOCATING]`, 'hex');
                playDataNoise(); // Audio Trigger
                await new Promise(r => setTimeout(r, 10));
            }
            consoleDiv.innerHTML = '';

            // PHASE 2: ASCII LOGO
            log(ASCII_LOGO, 'ascii');
            await new Promise(r => setTimeout(r, 500));

            // PHASE 3: LOG SEQUENCE
            for (let i = 0; i < bootSequence.length; i++) {
                const step = bootSequence[i];

                // Red Alert Logic
                if (step.text.includes("ERROR")) {
                    document.body.classList.add('alert-state');
                    document.querySelector('.terminal-container').classList.add('shake');
                }
                if (step.text.includes("SUCCESS") || step.text.includes("stabilized")) {
                    document.body.classList.remove('alert-state');
                    document.querySelector('.terminal-container').classList.remove('shake');
                }

                // Update UI
                const percent = Math.round(((i + 1) / bootSequence.length) * 100);
                progressBar.style.width = `${percent}%`;
                percentageText.innerText = `${percent}%`;

                const prompt = `<span class="text-green-500 mr-2">➜</span>`;
                log(`${prompt} ${step.text}`);
                taskStatus.innerText = step.text.replace(/<[^>]*>?/gm, '').substring(0, 30) + "...";

                playDataNoise(); // Audio Trigger

                // Delay with Overclock Multiplier
                await new Promise(r => setTimeout(r, step.delay * bootDelayMultiplier));
            }

            // PHASE 4: FINALE
            if (hum && hum.gain) {
                // Fix: Access .gain.gain to control volume
                hum.gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);
                setTimeout(() => hum.osc.stop(), 500);
            }

            playSuccessChime(); // Play Chime

            const finalLine = document.createElement('div');
            finalLine.className = 'text-green-500 font-bold text-xl mt-4';
            consoleDiv.appendChild(finalLine);

            decryptText(finalLine, "ACCESS GRANTED // WELCOME USER_01");
            await new Promise(r => setTimeout(r, 1500));

            // PHASE 5: CRT OFF & REDIRECT
            document.body.classList.add('redirecting');
            sessionStorage.setItem('system_booted', 'true');
            
            setTimeout(() => {
                window.location.href = 'home.html';
                
                // FALLBACK: If redirect hasn't happened after 1 second, show button
                setTimeout(() => {
                    document.getElementById('manual-entry').style.display = 'block';
                    document.body.classList.remove('redirecting'); // Stop the "screen off" effect so they can see the button
                }, 1000);
            }, 600);
        }

        // --- 5. EXTRAS (Overclock & Telemetry) ---
        let isOverclocked = false;
        let bootDelayMultiplier = 1;

        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && !isOverclocked) {
                isOverclocked = true;
                bootDelayMultiplier = 0.1;
                taskStatus.innerText = ">> SYSTEM OVERCLOCK ACTIVE <<";
                taskStatus.classList.add('text-red-500', 'animate-pulse');
                document.body.style.border = "5px solid red";
            }
        });

        document.addEventListener('keyup', (e) => {
            if (e.code === 'Space') {
                isOverclocked = false;
                bootDelayMultiplier = 1;
                taskStatus.innerText = "SYSTEM BOOT SEQUENCE";
                taskStatus.classList.remove('text-red-500', 'animate-pulse');
                document.body.style.border = "none";
            }
        });

        // Telemetry Loop
        setInterval(() => {
            const temp = Math.floor(Math.random() * (75 - 40) + 40);
            const volt = (Math.random() * (1.4 - 1.1) + 1.1).toFixed(2);
            const mem = Math.floor(Math.random() * (4096 - 200) + 200);

            document.getElementById('cpu-temp').innerText = `${temp}°C`;
            document.getElementById('sys-volt').innerText = `${volt}V`;
            document.getElementById('mem-usage').innerText = `${mem}MB`;

            const tempEl = document.getElementById('cpu-temp');
            if (temp > 70) tempEl.className = 'text-err font-bold animate-pulse';
            else tempEl.className = 'text-neonCyan';
        }, 800);

        // Start
        window.onload = runBoot;

    </script>
</body>

</html>